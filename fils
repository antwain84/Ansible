# Define the target directory
$targetDirectory = "C:\Path\To\Your\Directory"

# Get the cutoff date (3 years ago from today)
$cutoffDate = (Get-Date).AddYears(-3)

# Initialize total size variable
$totalSize = 0

# Get all files modified more than 3 years ago
$files = Get-ChildItem -Path $targetDirectory -Recurse -File | Where-Object {
    $_.LastWriteTime -lt $cutoffDate
}

# Calculate total size
foreach ($file in $files) {
    $totalSize += $file.Length
}

# Display results
Write-Output "Files modified more than 3 years ago in '$targetDirectory':"
$files | Select-Object FullName, LastWriteTime, Length | Format-Table -AutoSize

Write-Output "`nTotal size of files modified more than 3 years ago: $([math]::Round($totalSize / 1GB, 2)) GB ($totalSize bytes)"
